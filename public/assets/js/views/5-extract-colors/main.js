const _=e=>document.querySelector(e),thumbnail=_(".thumbnail img"),imgInput=_("#image-input"),canvas=_("#cs"),result=_(".result"),fake=_("#fake"),preview=_(".preview"),appPage=_(".app-page");let x="",y="";function useCanvas(e,t,a){e.width=t.width,e.height=t.height;let n=e.getContext("2d");return n.drawImage(t,0,0,t.width,t.height),n.imageSmoothingEnabled=!0,n.willReadFrequently=!0,a()}function componentToHex(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function rgbToHex(e,t,a){return"#"+componentToHex(e)+componentToHex(t)+componentToHex(a)}function findPos(e){let t=0,a=0;if(e.offsetParent){do{t+=e.offsetLeft,a+=e.offsetTop}while(e=e.offsetParent);return{x:t,y:a}}}imgInput.addEventListener("change",(e=>{fake.innerHTML=e.currentTarget.value.replace("C:\\fakepath\\","ğŸï¸ - ")}),!1),thumbnail.addEventListener("click",(function(e){e.offsetX?(x=e.offsetX,y=e.offsetY):e.layerX&&(x=e.layerX,y=e.layerY),useCanvas(canvas,thumbnail,(function(){let e=canvas.getContext("2d");e.imageSmoothingEnabled=!0,e.willReadFrequently=!0;let t=e.getImageData(x,y,1,1).data;result.innerHTML=`<span>HEX: ${rgbToHex(t[0],t[1],t[2])}</span><span>RGB:  rgb(${t[0]},${t[1]},${t[2]})</span>`,appPage.style.background=rgbToHex(t[0],t[1],t[2])}))}),!1),thumbnail.addEventListener("mousemove",(function(e){e.offsetX?(x=e.offsetX,y=e.offsetY):e.layerX&&(x=e.layerX,y=e.layerY),useCanvas(canvas,thumbnail,(function(){let e=canvas.getContext("2d").getImageData(x,y,1,1).data;preview.style.background=rgbToHex(e[0],e[1],e[2])}))}),!1),(()=>{const e=_("#image-input"),t=_("#image-display"),a=window.localStorage,n=4194304,o=()=>{let e=setTimeout((()=>{t.src=a.getItem("extract-colors-image"),clearTimeout(e)}),200)},r=()=>{if(e.files.length){let t=new FileReader;t.onload=e=>{const t=e.target.result;(e=>{const t=.75*e.length;return console.log(parseInt(t),parseInt(n)),!(parseInt(t)>parseInt(n)&&(alert("The size of the image exceeds the local storage quota."),1))})(t)&&(a.setItem("extract-colors-image",t),o())},t.readAsDataURL(e.files[0])}};(()=>{const t=_("#image-display").getAttribute("src");if(!a.getItem("extract-colors-image")){let e=setTimeout((()=>{a.setItem("extract-colors-image",t),clearTimeout(e)}),100)}o(),e.addEventListener("change",r,!1)})()})();